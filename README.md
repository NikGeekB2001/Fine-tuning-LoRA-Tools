# Медицинский ИИ-Ассистент

Интеллектуальный медицинский помощник на базе ИИ, использующий современные технологии обработки естественного языка для предоставления медицинских консультаций. Проект включает веб-интерфейс на Streamlit, продвинутую систему обработки медицинских запросов и базу знаний.

## Возможности

- **Медицинские консультации**: Ответы на вопросы о симптомах, лечении и профилактике
- **Распознавание сущностей**: Автоматическое выявление медицинских терминов в тексте
- **Извлечение ответов**: Точное извлечение информации из медицинской базы знаний
- **Веб-интерфейс**: Удобный интерфейс на базе Streamlit
- **Генеративные ответы**: Создание coherentных ответов с помощью GPT-моделей

## Технологии

- **Языковые модели**: RuBERT Large, RuGPT-3 Large
- **Финетюнинг**: LoRA адаптеры для эффективного обучения
- **Векторный поиск**: FAISS для быстрого поиска в базе знаний
- **NER**: Распознавание медицинских сущностей
- **Веб-фреймворк**: Streamlit для пользовательского интерфейса

## Структура проекта

```
Fine-tuning-LoRA-Tools/
├── advanced_medical_assistant.py    # Основной класс ассистента
├── advanced_streamlit_app.py        # Веб-приложение Streamlit
├── medical_tools.py                 # Инструменты для медицинского анализа
├── app.py                           # Простое Streamlit приложение
├── requirements.txt                 # Зависимости Python
├── models/                          # Обученные модели и адаптеры
│   ├── baseline_evaluation_results.json
│   └── lora_adapter/                # LoRA адаптер для NER
├── offload/                         # Офлоад модели для экономии памяти
├── src/                             # Дополнительные модули
└── README.md                        # Этот файл
```

## Установка и запуск

### Предварительные требования

- Python 3.8+
- CUDA-compatible GPU (рекомендуется для лучшей производительности)
- Минимум 16GB RAM

### Установка

1. **Клонируйте репозиторий:**
   ```bash
   git clone <repository-url>
   cd Fine-tuning-LoRA-Tools
   ```

2. **Создайте виртуальное окружение:**
   ```bash
   python -m venv venv
   ```

3. **Активируйте виртуальное окружение:**
   - Windows:
     ```bash
     venv\Scripts\activate
     ```
   - Linux/Mac:
     ```bash
     source venv/bin/activate
     ```

4. **Установите зависимости:**
   ```bash
   pip install -r requirements.txt
   ```

### Запуск приложения


```

Приложение будет доступно по адресу: http://localhost:8501

#### Консольный режим
```bash
python advanced_medical_assistant.py
```

## Использование

### В веб-интерфейсе

1. Откройте приложение в браузере
2. Введите ваш медицинский вопрос в текстовое поле
3. Нажмите "Получить консультацию"
4. Просмотрите ответ, включающий:
   - Анализ медицинских сущностей
   - Рекомендации
   - Предупреждения
   - Точный ответ из базы знаний

### Примеры вопросов

- "Что такое грипп?"
- "Как принимать парацетамол?"
- "Что делать при температуре 38°C?"
- "Какие симптомы при гипертонии?"
- "Можно ли принимать аспирин при головной боли?"

## Настройка

### Добавление медицинской информации

Отредактируйте `medical_tools.py` для добавления новых записей в `KNOWLEDGE_BASE`:

```python
KNOWLEDGE_BASE = {
    "doc_new": "Ваша новая медицинская информация здесь.",
    # ... существующие записи
}
```

### Настройка моделей

Модели настраиваются в `medical_tools.py`:
- `qa_model_name`: Модель для извлечения ответов
- `ner_model_name`: Модель для распознавания сущностей
- `embedding_model`: Модель для векторного поиска

## Модели и данные

### Обученные модели

- **QA модель**: Den4ikAI/rubert_large_squad_2
- **NER модель**: Den4ikAI/rubert_large_squad_2 с LoRA адаптером
- **Генеративная модель**: sberbank-ai/rugpt3large_based_on_gpt2

### Данные

- Медицинская база знаний на русском языке
- Обученные адаптеры LoRA для медицинского NER
- Векторные эмбеддинги для быстрого поиска

## Важные предупреждения

- **Не заменяет врача**: Система предоставляет общую информацию и не заменяет профессиональную медицинскую консультацию
- **Точность**: Ответы основаны на обученных моделях и могут содержать неточности
- **Экстренные случаи**: При серьезных симптомах немедленно обратитесь к врачу

## Вклад в проект

1. Fork репозиторий
2. Создайте feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit изменения (`git commit -m 'Add some AmazingFeature'`)
4. Push в branch (`git push origin feature/AmazingFeature`)
5. Откройте Pull Request

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл `LICENSE` для подробностей.

## Контакты

Для вопросов и предложений:
- Создайте issue в репозитории
- Напишите на email: [ваш-email@example.com]

---

**Примечание**: Проект находится в активной разработке. Регулярно проверяйте обновления.

